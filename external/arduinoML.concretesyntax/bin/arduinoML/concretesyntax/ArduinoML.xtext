// automatically generated by Xtext
grammar arduinoML.concretesyntax.ArduinoML with org.eclipse.xtext.common.Terminals

import "fr.uns.polytech.al.arduinoML" 
import "http://www.eclipse.org/emf/2002/Ecore" as ecore

App returns App:
	'app' name=EString 'initial state' initial=[State|EString] ':'
		'bricks :'
		bricks+=Brick
		(bricks+=Brick)*
		 
		'states :'
		states+=State
		(states+=State)* 
	;

Brick returns Brick:
	(Actuator | Sensor) name=EString ':' pin=EInt;

EString returns ecore::EString:
	STRING | ID;

State returns State:
	name=EString ':'
		actions+=Action
		(actions+=Action)*
		transitions+=Transition
		(transitions+=Transition)*
	;

EInt returns ecore::EInt:
	'-'? INT;

Actuator returns Actuator:
	{Actuator}
	'Actuator';

Sensor returns Sensor:
	{Sensor}
	'Sensor';

Action returns Action:
	'change' actuator=[Actuator|EString] 'to' value=Signal;

Transition returns Transition:
    'when' sensors+=[Sensor|EString] 'is' values+=Signal ('and' sensors+=[Sensor|EString] 'is' values+=Signal)* 'go to'(next=[State|EString]) | 'wait' time=EInt unit=Time_unit 'then go to' next=[State|EString];

enum Signal returns Signal:
				HIGH = 'HIGH' | LOW = 'LOW';
				
enum Time_unit returns Time_unit:
				ms = 'ms' | s = 's' | min = 'min';